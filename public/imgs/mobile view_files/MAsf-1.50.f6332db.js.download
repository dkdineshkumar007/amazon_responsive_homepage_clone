!function(){var e,t,n,i,o,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},s={},d=a.parcelRequire2640;function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}null==d&&((d=function(e){if(e in r)return r[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){s[e]=t},a.parcelRequire2640=d),d.register("a1rh1",(function(e,t){"use strict";function n(e,t,n,i){var o=[e,t,n];return i&&o.push(i),o}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.addCsmTag=e.exports.sendCsmCounter=e.exports.sendCsmLatencyMetric=void 0,e.exports.sendCsmLatencyMetric=function(e,t,i,o,a){var r;if(function(e){e.bb="uet",e.af="uet",e.cf="uet",e.be="uet",e.ld="uex"}(r||(r={})),r.hasOwnProperty(e)){var s=r[e].toString(),d=o?o+":":"";"function"==typeof window[s]&&(window[s].apply(this,n(e,"adplacements:"+d+t.replace(/_/g,":"),{wb:1},a)),i&&window[s].apply(this,n(e,"adplacements:"+d+i,{wb:1},a)))}},e.exports.sendCsmCounter=function(e,t,n,i){if(window.ue&&"function"==typeof window.ue.count){var o="adplacements:"+n;if(e&&(o+=":"+e.replace(/_/g,":")),window.ue.count(o,i),t){var a="adplacements:"+(n&&t?n+":":n)+t;window.ue.count(a,i)}}},e.exports.addCsmTag=function(e,t,n,i){if(window.ue&&window.ue.tag){if(t){var o=e+":"+t.replace(/_/g,":")+(i?":"+i:"");window.ue.tag(o)}if(n){var a=e+":"+n+(i?":"+i:"");window.ue.tag(a)}t||n||window.ue.tag(e+(i?":"+i:""))}}})),d.register("iMV0g",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.events=e.exports.latency=void 0;var n=d("ej7sS"),i=d("h1Sm4");e.exports.latency=function(e){return new n.CsaLatency(e)},e.exports.events=function(){return new i.CsaEvents}})),d.register("ej7sS",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CsaLatency=void 0;var n=d("1Fd0t"),i=function(e){var t=this;if(this.mark=function(e,i){if(t.latencyPlugin)try{t.latencyPlugin("mark",e,i)}catch(e){(0,n.logError)("Error with 'markCsaLatencyMetric' CSA",e)}},window.csa)try{this.latencyPlugin=window.csa("Content",{element:e})}catch(e){(0,n.logError)("Error with initiating CSA",e)}};e.exports.CsaLatency=i})),d.register("1Fd0t",(function(e,t){"use strict";var n=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.logError=void 0;var a=o(d("a1rh1")),r="ERROR";e.exports.logError=function(e,t){var n=t||new Error(e);console.error(e,t),a.sendCsmCounter("",null,"safeFrameError",1),window.sfHostLogErrors&&(window.ueHostLogError?window.ueHostLogError(n,{logLevel:r,attribution:"APE-safeframe",message:e+" "}):"undefined"!=typeof console&&console.error&&console.error(e,n))}})),d.register("h1Sm4",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CsaEvents=void 0;var n=d("1Fd0t"),i=function(){var e=this;if(this.log=function(t,i,o){if(e.events)try{e.events("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:t+":"+i+":"+o,metricValue:1},{ent:"all"})}catch(e){(0,n.logError)("Error with 'logCsaEvent' CSA",e)}},this.setEntity=function(t){if(e.events)try{e.events("setEntity",{adCreativeMetaData:t})}catch(e){(0,n.logError)("Error with 'addCsaEntity' CSA",e)}},window.csa)try{this.events=window.csa("Events",{producerId:"adplacements"})}catch(e){(0,n.logError)("Error with initiating CSA",e)}};e.exports.CsaEvents=i})),(t=e||(e={})).START="adload:start",t.CALLBACK="adload:delayloadcallback",t.IFRAME_CREATED="adload:iframecreated",(i=n||(n={})).SF_LIBRARY="cache:sflibrary:",i.SF_HTML="cache:sfhtml:",(o||(o={})).API="messenger:";const c={VERSION:"sfversion"};var u,p;(p=u||(u={})).NEXUS_CLIENT_NOT_DEFINED="ResourceTimingData.NexusClientNotDefined",p.LOGGING_FAILED="ResourceTimingData.LoggingFailed",p.LOGGING_SUCCESSFUL="ResourceTimingData.LoggingSuccessful",p.DEPENDENCIES_NOT_MET="ResourceTimingData.DependenciesNotMet";const m={ALLOWLISTED:"custommessage:allowlisted",NOT_ALLOWLISTED:"custommessage:notallowlisted"};var h,f,w,g,v,b;(f=h||(h={})).PAGE_PRERENDER="pixelcondition:pageprerender",f.AD_MISSING="pixelcondition:admissing",(g=w||(w={})).START="adload_start",g.CALLBACK="adload_delayload",g.IFRAME_CREATED="adload_iframecreated",(b=v||(v={})).SF_LIBRARY="sflibrary_",b.SF_HTML="sfhtml_";var y,E,S;function I(e,t,n,i,o){let a;if(function(e){e.bb="uet",e.af="uet",e.cf="uet",e.be="uet",e.ld="uex"}(a||(a={})),!a.hasOwnProperty(e))return;const r=a[e].toString(),s=i?i+":":"";"function"==typeof window[r]&&(window[r].apply(this,T(e,"adplacements:"+s+t.replace(/_/g,":"),{wb:1},o)),n&&window[r].apply(this,T(e,"adplacements:"+s+n,{wb:1},o)))}function A(e,t,n,i){if(window.ue&&"function"==typeof window.ue.count){let o="adplacements:"+n;if(e&&(o+=":"+e.replace(/_/g,":")),window.ue.count(o,i),t){const e="adplacements:"+(n&&t?n+":":n)+t;window.ue.count(e,i)}}}function R(e,t,n,i){if(window.ue&&window.ue.tag){if(t){const n=e+":"+t.replace(/_/g,":")+(i?":"+i:"");window.ue.tag(n)}if(n){const t=e+":"+n+(i?":"+i:"");window.ue.tag(t)}t||n||window.ue.tag(e+(i?":"+i:""))}}function T(e,t,n,i){const o=[e,t,n];return i&&o.push(i),o}(y||(y={})).VERSION="sfversion_",(S=E||(E={})).LOGGING_FAILED="resourceTimingData_LoggingFailed",S.LOGGING_SUCCESSFUL="resourceTimingData_LoggingSuccessful",S.DEPENDENCIES_NOT_MET="resourceTimingData_DependenciesNotMet",S.DEPENDENCIES_MET="resourceTimingData_DependenciesMet";const _=()=>window.innerHeight||document.documentElement.clientHeight,O=()=>window.innerWidth||document.documentElement.clientWidth,D=e=>e.getBoundingClientRect().top-_(),L=e=>{const t={atf:C(e)};if(!e||!window||!document)return t;const n=F(),i=H(e),o=U(e);return{atf:C(e),geom:{win:n,self:i,exp:o},payload:{wh:n.h,ww:n.w,sx:window.scrollX,sy:window.scrollY,ah:i.h,aw:i.w,top:i.t,left:i.l}}},C=e=>{if(!e)return"unknown";const t=function(e){if(!window||!(null===document||void 0===document?void 0:document.body))return null;const t=z(e,null),n=_(),i=O(),o=document.body.getBoundingClientRect(),a=Math.max(0,Math.min(o.left+i,t.r)-t.l),r=Math.max(0,Math.min(o.top+n,t.b)-t.t),s=a*r/(t.h*Math.min(t.w,i));return Number(Math.min(1,Math.max(0,s)).toFixed(2))}(e);return null==t?"unknown":t>=.5};const M=e=>{if(!window||!document)return null;const t=k(e),n=F(),i=H(null,t);return{atf:"unknown",geom:{win:n,self:i,exp:U(null,t)},payload:{wh:n.h,ww:n.w,sx:window.scrollX,sy:window.scrollY,ah:i.h,aw:i.w,top:i.t,left:i.l}}},N=(e,t)=>{const n=z(e),i=z(t),o=O(),a=_();return n&&i&&(Math.abs(n.t-i.b)<a||Math.abs(n.b-i.t)<a)&&(Math.abs(n.l-i.r)<o||Math.abs(n.r-i.l)<o)},k=e=>{const t=e.initialBoundingRect,n=t.top-(window.scrollY-e.originalScrollY),i=n+e.adHeight,o=t.left-(window.scrollX-e.originalScrollX);return{top:n,bottom:i,left:o,right:o+e.adWidth,width:e.adWidth,height:e.adHeight}},x=(e,t,n)=>{let i=0;return"visible"!==document.visibilityState?i:(i=e>0?n-e:t>0?Math.min(t,n):0,Math.min(i,t-e))},F=()=>{const e=window.screenY?window.screenY:window.screenTop,t=window.screenX?window.screenX:window.screenLeft,n=O(),i=_();return{t:e,l:t,w:n,h:i,b:e+i,r:t+n}},H=(e,t)=>{const n=z(e,t),i=B(n);return{t:n.t,l:n.l,r:n.r,b:n.b,w:n.w,h:n.h,z:n.z,xiv:i.xiv,yiv:i.yiv,iv:i.iv}},z=(e,t)=>{const n=t||(null==e?void 0:e.getBoundingClientRect());return{t:n.top,l:n.left,r:n.right,b:n.bottom,w:n.width,h:n.height,z:e?Number(window.getComputedStyle(e,null).zIndex):NaN}},B=e=>{const t=O(),n=_(),i=Math.max(0,x(e.t,e.b,n)),o=Math.max(0,x(e.l,e.r,t)),a=i*o,r=e.h*Math.min(e.w,t);return 0!==r||0!==a?{xiv:Number(Math.min(1,o/e.w).toFixed(2)),yiv:Number(Math.min(1,i/e.h).toFixed(2)),iv:Number(Math.min(1,Math.max(0,a/r)).toFixed(2))}:{xiv:0,yiv:0,iv:0}},U=(e,t)=>{const n=t||(null==e?void 0:e.getBoundingClientRect());return{t:n.top,l:n.left,r:O()-n.right,b:_()-n.bottom,xs:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)>O()?1:0,yx:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)>_()?1:0}},j=()=>window.P&&window.P.AUI_BUILD_DATE,V=(e,t,n)=>{var i;return j()&&"function"==typeof(null===window||void 0===window||null===(i=window.P)||void 0===i?void 0:i.guardError)?P.guardError("APE-SafeFrame",e):(...i)=>{try{e(...i)}catch(e){"function"==typeof t&&n&&t(n,e)}}},W=(e,t)=>{if(e&&t)for(const n in t)e.style[n]=t[n];return e},J={1027:"Sponsored Display DRA"},q=(e,t)=>(e=>"V"===e)(e)&&!J.hasOwnProperty(t),G=e=>(e=>{let t,n="";const i=e.length;for(let o=0;o<i;o++)t=e[o],n+=String.fromCodePoint(t>251&&t<254&&o+5<i?1073741824*(t-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>247&&t<252&&o+4<i?(t-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>239&&t<248&&o+3<i?(t-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>223&&t<240&&o+2<i?(t-224<<12)+(e[++o]-128<<6)+e[++o]-128:t>191&&t<224&&o+1<i?(t-192<<6)+e[++o]-128:t);return n})(((e,t)=>{const n=e.replace(/[^A-Za-z0-9+/]/g,""),i=n.length,o=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,a=new Uint8Array(o);let r,s,d=0,l=0;for(let e=0;e<i;e++)if(s=3&e,d|=((c=n.charCodeAt(e))>64&&c<91?c-65:c>96&&c<123?c-71:c>47&&c<58?c+4:43===c?62:47===c?63:0)<<6*(3-s),3===s||i-e==1){for(r=0;r<3&&l<o;)a[l]=d>>>(16>>>r&24)&255,r++,l++;d=0}var c;return a})(e));function Y(e,t,n){var i,o=n||{},a=o.noTrailing,r=void 0!==a&&a,s=o.noLeading,d=void 0!==s&&s,l=o.debounceMode,c=void 0===l?void 0:l,u=!1,p=0;function m(){i&&clearTimeout(i)}function h(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=this,l=Date.now()-p;function h(){p=Date.now(),t.apply(s,o)}function f(){i=void 0}u||(d||!c||i||h(),m(),void 0===c&&l>e?d?(p=Date.now(),r||(i=setTimeout(c?f:h,e))):h():!0!==r&&(i=setTimeout(c?f:h,void 0===c?e-l:e)))}return h.cancel=function(e){var t=(e||{}).upcomingOnly,n=void 0!==t&&t;m(),u=!n},h}class Q{sendLatencyMetric({latencyMetricType:e,placementId:t,placementName:n,timestamp:i}){I(e.csmKey,n,t,e.csmMessage,null==i?void 0:i.getTime()),function(e,t,n){const i=function(e){return document.getElementById(function(e){return"ape_"+e+"_placement"}(e))}(t);i&&(Re(i),Te(e.csaKey,null==n?void 0:n.getTime()))}(e,n,i)}}const X=()=>new Q,K="sfImpression",$="LightAdImpression",Z=(e,t,n)=>({csaKey:e,csmKey:t,csmMessage:n}),ee=Z("bodyBegin","bb",K),te=(Z("bodyBegin","bb",$),Z("bodyEnd","be"),Z("clickToATF","af")),ne=Z("criticalFeature","cf"),ie=(Z("criticalFeature","cf",K),Z("criticalFeature","cf",$),Z("loaded","ld"),Z("loaded","ld",K),Z("loaded","ld",$),Z("viewablelatency:loaded","ld","viewablelatency")),oe="ERROR";function ae(e,t){const n=t||new Error(e);console.error(e,t),A("",null,"safeFrameError",1),window.sfHostLogErrors&&(window.ueHostLogError?window.ueHostLogError(n,{logLevel:oe,attribution:"APE-safeframe",message:e+" "}):"undefined"!=typeof console&&console.error&&console.error(e,n))}const re=()=>{const e=window.location.hostname.split(".").pop();let t="na";return/^(com|ca|mx|br)$/.test(e)?t="na":/^(uk|de|fr|it|es|in|ae|sa|nl|tr|se|pl|eg|be)$/.test(e)?t="eu":/^(jp|au|sg)$/.test(e)?t="fe":/^(cn)$/.test(e)&&(t="cn"),"https://images-"+t+".ssl-images-amazon.com"},se=(e,t)=>e.height===t.height&&e.width===t.width,de=(e,t,n)=>{if(!t||"object"!=typeof t)return!1;for(let i=0,o=t.length;i<o;i++)if(n(e,t[i]))return!0;return!1},le=()=>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window,ce=e=>e&&0===Object.keys(e).length&&e.constructor===Object;function ue(e,t){const n=document.createElement("iframe");return n.name=JSON.stringify(e),n.id=t,n.height=be(e.size.height)||"250px",n.width=be(e.size.width)||"300px",n.className=e.iframeClass||"",n.setAttribute("frameborder","0"),n.setAttribute("marginheight","0"),n.setAttribute("marginwidth","0"),n.setAttribute("scrolling","no"),n.setAttribute("allowtransparency","true"),n.setAttribute("data-arid",e.arid),n.style.cssText=e.iframeExtraStyle||"",n}const pe=["allow-scripts","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"],me=pe.concat(["allow-same-origin"]),he=(e,t,n)=>{const i=ue(e,t);return i.srcdoc=decodeURIComponent(n),i.sandbox=pe.join(" "),i},fe=(e,t,n)=>{const i=ue(e,t);return i.src=n,i.sandbox=me.join(" "),i};function we(e){const t=document.getElementById(e);void 0!==t&&t&&(t.style.display="none")}function ge(e,t,n){const i=document.getElementById(t[e].placementDivId),o=document.getElementById(t[e].wrapperDivId)||i,a=document.getElementById(t[e].iframeId);let r=n.resizePlacementWidthThreshold;const s=n.resizePlacementStyleAboveThreshold,d=n.resizePlacementStyleBelowThreshold;r=parseInt(r,10),o&&a&&r&&s&&d&&(o.offsetWidth<r?W(a,d):W(a,s))}function ve(e,t,n,i,o,a){try{const r=document.getElementById(a[e].placementDivId),s=document.getElementById(a[e].wrapperDivId)||r,d=document.getElementById(a[e].iframeId);if(null===s||null===r||null===d)return;const l=ye(n),c=ye(t),u=!c&&!l,p=parseInt(t,10);let m=c?d.offsetWidth:p,h=l?d.offsetHeight:parseInt(n,10);const f=parseInt(i,10),w=e=>{u&&(h=Math.round(e*h/m)),m=Math.round(e)},g=0===s.offsetWidth?O():s.offsetWidth;f&&_()<O()?w(f):w(g),o&&o.adMap&&o.adMap[e]&&o.adMap[e].options&&o.adMap[e].options.slotSnapshot&&(o.adMap[e].options.slotSnapshot.adHeight=h,o.adMap[e].options.slotSnapshot.adWidth=m);const v=be(m),b=be(u?h:n);d.style.height=b,d.style.width=v;const y={width:v,height:b};s!==r&&(r.style.height=b,o.sendMessageToAd(e,"resizeCreativeWrapper",y)),"Detail_hero-quick-promo_Desktop"===a[e].slotId&&(A(a[e].slotId,o.adMap[e].options.placementId,"OffsetLeft",d.offsetLeft),A(a[e].slotId,o.adMap[e].options.placementId,"OffsetTop",d.offsetTop),A(a[e].slotId,o.adMap[e].options.placementId,"OffsetWidth",d.offsetWidth),A(a[e].slotId,o.adMap[e].options.placementId,"OffsetHeight",d.offsetHeight))}catch(t){ae("Error resizing ad: "+a[e].slotId,t)}}function be(e){return!e||ye(e)||function(e){return e.length>2&&"px"===e.substring(e.length-2)}(e)?e:e+"px"}function ye(e){return e.length>1&&"%"===e.charAt(e.length-1)}function Ee(e,t,n,i,o){const a="undefined"!=typeof P,r="undefined"!=typeof amznJQ,s="number"==typeof n&&0!==n?()=>{setTimeout(t,n)}:t,d=!!o&&JSON.parse(o);if(void 0===e)s();else if("windowOnLoad"===e)"complete"===document.readyState?s():window.addEventListener("load",s);else if("spATFEvent"===e)a?P.when("search-page-utilities").execute((e=>{window.searchPageUtils.afterEvent("spATFEvent",s)})):r?amznJQ.available("search-js-general",(()=>{window.SPUtils.afterEvent("spATFEvent",s)})):s();else if("aboveTheFold"===e)a?P.when("af").execute(s):r?amznJQ.onCompletion("amznJQ.AboveTheFold",s):s();else if("criticalFeature"===e)a?P.when("cf").execute(s):r?amznJQ.onCompletion("amznJQ.criticalFeature",s):s();else if("r2OnLoad"===e)a?P.when("r2Loaded").execute(s):r?amznJQ.onReady("r2Loaded",s):s();else if(e.match("[^:]+:.+")){const t=e.split(":"),n=t[0].split("."),i=t[1],o=t.length>2?t[2]:i;a?P.when(o,"A").execute(s):r&&n.length>1?amznJQ[n[1]](i,s):s()}else if(e.match(/^\d{1,4}px$/g))Se(parseInt(e,10),s,i,d,((e,t)=>{const n=D(e);return e&&n<=t}));else{const t=/^reached(\d{1,5}px)FromTop$/g.exec(e);t?Se(parseInt(t[1],10),s,i,d,((e,t)=>window.scrollY+_()>=t)):s()}}function Se(e,t,n,i,o){let a=!1;const r=()=>{o(n,e)&&(t(),a=!0)},s=V(Y(20,(()=>{r(),a&&(window.removeEventListener("scroll",s),window.removeEventListener("resize",s))})));window.addEventListener("scroll",s),window.addEventListener("resize",s),i&&r()}const Ie=new class{customMessage(e,t,n,i,o){const a=this.msgListeners;try{"undefined"!==n&&Array.isArray(n)&&(n.indexOf(e)>-1&&a[e]?(A(null,null,m.ALLOWLISTED+":"+e,1),a[e](t)):-1===n.indexOf(e)?(A(null,null,m.NOT_ALLOWLISTED,1),A(i,o,m.NOT_ALLOWLISTED,1)):ae("Unrecognized custom message key: "+e))}catch(e){ae("Custom Message Error",e)}}isElementInDOM(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}constructor(e,t,n){l(this,"adMap",void 0),l(this,"supportedCommands",void 0),l(this,"msgListeners",void 0),l(this,"getIframe",(e=>{var t;const n=this.adMap,i=n[e].options;if(ce(n)||ce(i))return null;const o="ape_"+i.slot+"_iframe";return n[e].iframe&&(n[e].iframe=n[e].iframe&&(null===(t=n[e].iframe)||void 0===t?void 0:t.innerHTML)?n[e].iframe:document.getElementById(o)),n[e].iframe})),l(this,"sendMessageToAd",((e,t,n)=>{const i=this.getIframe(e),o=i?i.contentWindow:null;if(o){const e={command:t,data:n};o.postMessage(e,"*")}})),l(this,"receiveMessage",(e=>{const t=e=>{for(const n in this.adMap){var t;if((null===(t=this.getIframe(n))||void 0===t?void 0:t.contentWindow)===e.source)return!0}return!1},n=this.adMap;if(ce(n))return;try{var i,o,a,r;if((null===(r=null==e||null===(i=e.data)||void 0===i||null===(o=i.message)||void 0===o||null===(a=o.id)||void 0===a?void 0:a.toLowerCase())||void 0===r?void 0:r.indexOf("mash"))>-1)throw"Received Mash message"}catch(e){return}const s=e.data,d=n[s.arid];try{const n=this.supportedCommands,i=((e,n)=>e&&e.options&&t(n))(d,e);if("object"!=typeof s.data||!n.hasOwnProperty(s.command))return;if(!i)throw"Invalid Message Origin: "+e.origin;const o=n[s.command];o&&(d.options.debug&&"undefined"!=typeof console&&console.log(e),o(d,s.data))}catch(t){let n="Problem with message: "+e.data;void 0!==s&&(n+=this.appendErrorDetails(s.arid)),ae(n,t)}})),l(this,"appendErrorDetails",(e=>{const t=this.adMap;if(ce(t))return"";let n="";if(void 0!==t[e]){const i=t[e].options;void 0!==i.aanResponse&&(n=" Ad Details: "+JSON.stringify(i.aanResponse))}return n})),l(this,"registerCustomMessageListener",((e,t,n)=>{let i=!1;const o=this.msgListeners;try{if(!o[e]||"function"!=typeof o[e]||n)o[e]=t,i=!0;else{ae("Duplicate Key",new Error("Custom message listener already exists for key: "+e))}}catch(e){ae("Error registering custom message listener",e)}return i})),l(this,"sendCustomMessage",((e,t)=>{const n=this.adMap,i={key:e,data:t};for(const e in n)this.sendMessageToAd(e,"customMessage",i)})),l(this,"sendCustomMessageToAd",((e,t,n)=>{const i={key:t,data:n};this.sendMessageToAd(e,"customMessage",i)})),l(this,"takeSnapshotOfSlotPosition",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options;if(!t||ce(t)||!n||ce(n))return;const i=this.getIframe(e);var o;this.adMap[e].options.slotSnapshot={initialBoundingRect:(o=i).getBoundingClientRect(),adHeight:o.offsetHeight,adWidth:o.offsetWidth,originalScrollX:window.scrollX,originalScrollY:window.scrollY}})),l(this,"startPixelTracking",((e,t)=>{let n="prerender"!==document.visibilityState;const i=this.getIframe(e);let o,a,r=this.isElementInDOM(i);const s=this.adMap&&this.adMap[e]&&this.adMap[e].options;!n&&s&&A(s.slot,s.placementId,h.PAGE_PRERENDER,1),!r&&s&&A(s.slot,s.placementId,h.AD_MISSING,1);const d=()=>!(!n||!r)&&(t(),a&&document.removeEventListener("visibilitychange",a),o&&le()&&o.unobserve(i),!0);if(!d()){const e={root:document.documentElement};le()&&(o=new IntersectionObserver((e=>{try{if(1===e.length){e[0].isIntersecting?(r=!0,d()):r=!1}}catch(e){ae("Error executing intersectionObserver callback")}}),e),o.observe(i)),a=()=>{try{"prerender"!==document.visibilityState?(n=!0,d()):n=!1}catch(e){ae("Error executing pageVisibilityHandler callback")}},document.addEventListener("visibilitychange",a)}})),l(this,"updateViewability",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options;if(!t||ce(t)||!n||ce(n))return;const i=this.getIframe(e),o=t[e].options.viewabilityStandards,a=L(i);null!==a&&(a.viewabilityStandards=o,this.sendMessageToAd(e,"updateViewability",a))})),l(this,"updateNoInventoryViewability",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options,i=n&&n.slotSnapshot;if(!t||ce(t)||!n||ce(n)||!i)return;const o=n.viewabilityStandards,a=M(i);null!==a&&(a.viewabilityStandards=o,this.sendMessageToAd(e,"updateViewability",a))})),this.adMap=e||{},this.supportedCommands=t||{},this.msgListeners=n||{}}};const Ae=new class{constructor(){l(this,"latencyPlugin",void 0),l(this,"events",void 0)}},Re=e=>{window.csa?Ae.latencyPlugin=window.csa("Content",{element:e}):console.log(window)},Te=(e,t)=>{try{Ae.latencyPlugin("mark",e,t)}catch(e){ae("Error with initiating CSA",e)}},_e=(e,t,n)=>{try{Ae.events("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t+":"+n,metricValue:1},{ent:"all"})}catch(e){ae("Error with initiating CSA",e)}},Oe=e=>{try{Ae.events("setEntity",{adCreativeMetaData:e})}catch(e){ae("Error with initiating CSA",e)}};function De(e,t,n,i,o,a){try{let r=null;if(window.XMLHttpRequest?r=new XMLHttpRequest:a(),r){if(r.onreadystatechange=()=>{o(r)},r.open(t,e,!0),null!==i)for(const e in i)r.setRequestHeader(e,i[e]);r.send(n)}else a()}catch(e){a()}}class Le{logTrace(e,t){if(void 0!==this.traceId){let n;const i=(new Date).getTime();this.storedTrace.hasOwnProperty(e)||(this.storedTrace[e]=[]);t===Object(t)?n=Object.assign&&"function"==typeof Object.assign?Object.assign({},t):JSON.parse(JSON.stringify(t)):(n='{ "'+e+'":"'+t+'"}',n=JSON.parse(n)),n.timeStamp=i,n.timeSinceAdStart=i-this.adStartTime,this.storedTrace[e].push(n)}}constructor(e,t){l(this,"traceId",void 0),l(this,"adStartTime",void 0),l(this,"storedTrace",void 0),l(this,"allData",void 0),this.traceId=e,this.adStartTime=t,this.storedTrace={};void 0!==e&&(()=>{const e=()=>{const e=()=>{console.log("failed to send request to /gp/adbarplus")},t=t=>{4===t.readyState&&200!==t.status&&e()};if(!(e=>{for(const t in e)if(e.hasOwnProperty(t))return!1;return!0})(this.storedTrace)){De("/gp/adbarplus?traceId="+this.traceId+"&systemName=browser","POST",JSON.stringify(this.storedTrace),{"Content-Type":"application/x-www-form-urlencoded"},t,e);for(const e in this.storedTrace)this.storedTrace.hasOwnProperty(e)&&delete this.storedTrace[e]}},t=(e,t)=>()=>e.apply(t),n=()=>{e()},i=()=>{e(),window.setInterval(t(n,this),3e3)};"loading"!==document.readyState?t(i,this)():window.addEventListener("load",t(i,this))})()}}var Ce,Me,Ne=new RegExp(/((&#[0-9]{2};)|(&#[0-9]{3};)|(&#[0-9]{4};)|(&[a-z]{2};)|(&[a-z]{3};)|(&[a-z]{4};)|(&[a-z]{5};)|(&[a-z]{6};)|(&[a-z]{7};)|(%[a-fA-F0-9]{2})|(\W))pd_rd_plhdr(=|%3D)t((&#[0-9]{2};)|(&#[0-9]{3};)|(&#[0-9]{4};)|(&[a-z]{2};)|(&[a-z]{3};)|(&[a-z]{4};)|(&[a-z]{5};)|(&[a-z]{6};)|(&[a-z]{7};)|(%[a-fA-F0-9]{2})|(\W))/),Pe="$1",ke="$14";Me=function(){return document};var xe="data-val";function Fe(e){if("string"!=typeof e||""===e)return"";var t=Me().getElementById("ape_"+e+"_placement_ClickTracking");if(!(t&&t.hasAttribute&&"function"==typeof t.hasAttribute&&t.hasAttribute(xe)&&t.getAttribute&&"function"==typeof t.getAttribute))return"";var n=t.getAttribute(xe);return"string"!=typeof n?"":n}Ce=function(e,t,n){return Fe([e,n,t].join("_"))};const He=e=>{if(!("pageType"in e)||!("subPageType"in e)||!("slotName"in e))return"";try{return Ce(e.pageType,e.subPageType,e.slotName)}catch(e){return""}},ze={};function Be(e,t,n){e&&e.id&&!ze[e.id]&&window.P&&j()&&window.P.when("gw-video-orchestrator").execute((i=>{i.subscribe(e,t,n),ze[e.id]=!0}))}let Ue=null;function je(e,t,n){const i=t=>{n.sendCustomMessageToAd(e.options.arid,"videoAutoplayResponse",t)};var o;e.options.expParams&&e.options.expParams.noVideoAutoplay?i(!1):(o=e.options.pageType)&&"gateway"===o.toLowerCase()?Be(e.iframe,i,t):Ue===e.options.arid?i(!0):null===Ue&&function(e){const t=document.getElementsByTagName("video");for(let n=0;n<t.length;++n)if(!t[n].paused&&N(e,t[n]))return!1;return!0}(e.iframe)?(Ue=e.options.arid,i(!0)):i(!1)}function Ve(){j()&&window.P&&window.P.when("gw-video-orchestrator").execute((e=>{e.elect()})),Ue=null}function We(e){var t;(t=e.iframe)&&window.P&&j()&&window.P.when("gw-video-orchestrator").execute((e=>{e.elect(t)})),Ue=e.options.arid}const Je="unfired_cod_impressions_dictionary";function qe(){let e;try{e=JSON.parse(localStorage.getItem(Je)||"{}")}catch(t){e={}}return e}function Ge(){try{localStorage.removeItem(Je)}catch(e){}}function Ye(e,t){const n=qe();n[e]=t,Ke(n)}function Qe(){const e=qe(),t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&""!==e[n]&&t.push(e[n]);return Ge(),t}function Xe(e){const t=qe();t[e]&&(t[e]="",Ke(t))}function Ke(e){try{localStorage.setItem(Je,JSON.stringify(e))}catch(e){}}var $e,Ze,et,tt,nt,it;(Ze=$e||($e={})).IMPRESSION="localstorage:impression",Ze.ERROR="localstorage:error",Ze.CONTROL="localstorage:inactive",Ze.TREATMENT="localstorage:t1",Ze.NO_WEBLAB="localtestorage:missing",(tt=et||(et={})).IMPRESSION="localstorage_impression",tt.ERROR="localstorage_error",tt.CONTROL="localstorage_inactive",it=function(){return URL};var ot="{}",at="?",rt="&",st="=";function dt(e,t){var n={};for(var i in e)n[i]=e[i];for(var o in t)n[o]=t[o];return n}nt=function(e,t,n){if("string"!=typeof e||""===e)throw new Error("Invalid url input to addJSONQueryParamToURL: "+JSON.stringify({url:e}));if("string"!=typeof t||""===t)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));if("object"!=typeof n)throw new Error("Invalid queryParamValueObject input to addJSONQueryParamToURL: "+JSON.stringify({queryParamValueObject:n}));try{var i=new(it())(e),o=i.searchParams.get(t)?i.searchParams.get(t):"{}",a=JSON.parse(o);if("object"!=typeof a)throw new Error("Existing query param value was not an object: "+JSON.stringify({existingJSONObject:a}));var r=dt(a,n);return i.searchParams.set(t,JSON.stringify(r)),i.toString()}catch(i){return function(e,t,n){var i,o=e.indexOf(at),a={};if(o>0){i=e.substring(0,o),decodeURIComponent(e.substring(o+1)).split(rt).forEach((function(e){if(e){var t=e.split(st);a[t[0]]=t[1]}}));var r=a[t]?a[t]:ot,s=JSON.parse(r);if("object"!=typeof s)throw new Error("Existing query param value was not an object: "+JSON.stringify({existingJSONObject:s}));var d=dt(s,n);a[t]=JSON.stringify(d)}else i=e,a[t]=JSON.stringify(n);var l=[];for(var c in a)l.push(encodeURIComponent(c)+st+encodeURIComponent(a[c]));return i+at+l.join(rt)}(e,t,n)}};const lt=(e,t)=>{const n=!(!e.options.expParams||!e.options.expParams.enableViewabilityTrackerOnLoad)&&JSON.parse(e.options.expParams.enableViewabilityTrackerOnLoad),i=()=>{try{Xe(e.options.arid),Ie.sendMessageToAd(e.options.arid,"fireImpression",t),ct(!n,e,t)}catch(e){ae("Error firing pixels. data: "+JSON.stringify(t))}};ct(n,e,t);const o=V((()=>{Ie.startPixelTracking(e.options.arid,i)}));Ee(e.options.firePixelsAfter,o,0,e.slot,e.options.expParams?e.options.expParams.firePositionTrackerOnLoad:"false")},ct=(e,t,n)=>{e&&(n.isNoInventory?Ie.supportedCommands.enableNoInventoryViewabilityTrackerAndInvokeFallback(t):Ie.supportedCommands.enableViewabilityTracker(t))};function ut(e){Ie.startPixelTracking(e.options.arid,(()=>{try{if(e.options.aaxImpPixelUrl){const t=nt(e.options.aaxImpPixelUrl,"pj",{measurementMethod:"cod_client"});Ye(e.options.arid,t)}Ie.sendMessageToAd(e.options.arid,"fireMetricsForLegacyImpression",{})}catch(e){ae("Error firing legacy impression metrics")}}))}function pt(e){return window[e]&&"object"==typeof window[e].adDetails?window[e].adDetails:null}const mt=e=>{e.fallbackStaticAdClickUrl&&((e=>{let t="";return e&&(t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]),0!==t.length})(e.fallbackStaticAdClickUrl)||(e.fallbackStaticAdClickUrl=window.location.protocol+"//"+window.location.host+e.fallbackStaticAdClickUrl))};function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){l(e,t,n[t])}))}return e}function ft(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var wt,gt;(gt=wt||(wt={})).BEGIN_TO_RENDER_CLIENT="btr_client",gt.COUNT_ON_DOWNLOAD_CLIENT="cod_client";const vt=(e,t,n,i,o)=>{const a=document.createElement("img");a.id=t,a.src=e,a.style.display="none",a.onload=i,a.onerror=o,n.appendChild(a)};var bt,yt,Et,St;!function(e){e.IFRAME_INIT="adload:iframeinitialized",e.RENDER_START="adload:renderstart",e.RENDER_END="adload:renderend",e.CREATIVE_WRITTEN="adload:creativewritten",e.IMP="adload:impression",e.UNSERVED_IMP="adload:unservedimpression",e.VIEWABILITY="adload:viewability",e.UNSERVED_VIEWABILITY="adload:unservedviewability",e.MEASURABILITY="adload:measurability",e.MEASUREMENT_HTML="adload:measurementhtml"}(bt||(bt={})),(Et=yt||(yt={})).REQUEST_START="adfetch:request",Et.PUNT_RETURNED="adfetch:punt",Et.ERROR_RETURNED="adfetch:error",Et.EMPTY_RESPONSE="adfetch:noad",Et.RENDERED_AD="adfetch:renderad",Et.RENDER_ERROR="adfetch:rendererror",Et.HTTP_ERROR="adfetch:httperror",Et.EXCEPTION="adfetch:exception",function(e){e.DEPENDENCIES_NOT_MET="ResourceTimingData.DependenciesNotMet"}(St||(St={}));var It,At,Rt,Tt;function _t(e,t,i,o,a,r){if("undefined"==typeof performance||void 0===performance.getEntriesByType)return;const s=performance.getEntriesByType("resource");if(void 0===s||!Array.isArray(s)||s.length<1||void 0===s[0].duration)return;const d=e=>{a(i,o,e,1)},l=void 0!==s[0].transferSize?(e,t,n)=>{0===e.transferSize?(d(t+"cached"),r(n+"cached",i,o)):(d(t+"uncached"),r(n+"uncached",i,o))}:(e,t,n)=>{e.duration<20?(d(t+"fastload"),r(n+"fastload",i,o)):(d(t+"slowload"),r(n+"slowload",i,o))},c=(e,t,n)=>{if(e)for(let i=0;i<s.length;i++){const o=s[i];if(o.name&&-1!==o.name.indexOf(e))return void l(o,t,n)}};c(e,n.SF_LIBRARY,v.SF_LIBRARY),c(t,n.SF_HTML,v.SF_HTML)}(At=It||(It={})).LEGACY_IMPRESSION_COUNTER="imp:legacy",At.GLOBAL_IMPRESSION_FIRED_COUNTER="impressionFired",(Tt=Rt||(Rt={})).LOADED="btr:loaded",Tt.ERROR="btr:error",Tt.IMPRESSION="btr:impression",Tt.NO_IMAGES="btr:noimages",Tt.TAGGED="btr:taggedcreative";const Ot=e=>e+"_Feedback";var Dt,Lt;(Lt=Dt||(Dt={}))[Lt.BOTTOM=0]="BOTTOM",Lt[Lt.TOP=1]="TOP";class Ct{async addSponsoredLabelWithFeedbackLink(e,t){e.appendChildTo(this.parentHtmlId,this);const n=await t.getSponsoredLabelAndFeedbackLink(this.urlPathAndParameter);return(null==n?void 0:n.isOk())?(e.updateElement(this.getHtmlId(),n),n):null}getHtmlId(){return Ot(this.parentHtmlId)}isHidden(){return this.hidden}constructor(e,t,n,i,o,a,r){l(this,"parentHtmlId",void 0),l(this,"feedbackStyle",void 0),l(this,"labelText",void 0),l(this,"labelStyle",void 0),l(this,"position",void 0),l(this,"urlPathAndParameter",void 0),l(this,"hidden",void 0),this.parentHtmlId=e,this.feedbackStyle=t,this.labelText=n,this.labelStyle=i,this.position=o,this.urlPathAndParameter=a,this.hidden=r}}class Mt{open(e){e.clickChildLink(this)}getHtmlId(){return Ot(this.parentHtmlId)}constructor(e){l(this,"parentHtmlId",void 0),this.parentHtmlId=e}}class Nt{createSponsoredLabelWithFeedbackLink(e,t){t.request(),e.addSponsoredLabelWithFeedbackLink(this.feedbackHtmlPort,this.feedbackApiPort).then((n=>{t.success(n),e.isHidden()||t.labelRenderedHost()})).catch((()=>{t.error()}))}openModal(e){e.open(this.feedbackHtmlPort)}labelRendered(e){e.labelRenderedCreative()}constructor(e,t){l(this,"feedbackHtmlPort",void 0),l(this,"feedbackApiPort",void 0),this.feedbackHtmlPort=e,this.feedbackApiPort=t}}class Pt{logFeedbackRequest(){kt(this.tracer,this.tracerFeedback.feedbackRequest)}logFeedbackResponse(e,t){kt(this.tracer,this.tracerFeedback.feedbackResponse(t,e))}logRenderSponsoredLabel(){kt(this.tracer,this.tracerFeedback.renderSponsoredLabel)}constructor(e,t){l(this,"tracerFeedback",void 0),l(this,"tracer",void 0),this.tracerFeedback=e,this.tracer=t}}const kt=(e,t)=>{null==e||e.logTrace("adFeedBack",t)};var xt,Ft;(Ft=xt||(xt={})).REQUEST="adfeedback:request",Ft.SUCCESS="adfeedback:success",Ft.ERROR="adfeedback:error",Ft.LABEL_RENDERED_CREATIVE="adfeedback:sponsoredlabelrendered:creative",Ft.LABEL_RENDERED_HOST="adfeedback:sponsoredlabelrendered:host";class Ht{incrementRequest(){zt(xt.REQUEST,this.placementId,this.placementName)}incrementSuccess(){zt(xt.SUCCESS,this.placementId,this.placementName)}incrementError(){zt(xt.ERROR,this.placementId,this.placementName)}incrementLabelRenderedHost(){zt(xt.LABEL_RENDERED_HOST,this.placementId,this.placementName)}incrementLabelRenderedCreative(){zt(xt.LABEL_RENDERED_CREATIVE,this.placementId,this.placementName)}constructor(e,t){l(this,"placementName",void 0),l(this,"placementId",void 0),this.placementName=e,this.placementId=t}}const zt=(e,t,n)=>{A(n,t,e,1)};var Bt={},Ut=Bt&&Bt.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),jt=Bt&&Bt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Vt=Bt&&Bt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&Ut(t,e,n);return jt(t,e),t};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.AD_LOAD_COUNTERS=Bt.csa=Bt.csm=void 0;var Wt=Vt(d("a1rh1"));Bt.csm=Wt;var Jt=Vt(d("iMV0g"));Bt.csa=Jt;var qt,Gt,Yt={};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.AD_LOAD_COUNTERS=void 0,Yt.AD_LOAD_COUNTERS={HTML_REACHED:"adload:htmlreached"},Object.defineProperty(Bt,"AD_LOAD_COUNTERS",{enumerable:!0,get:function(){return Yt.AD_LOAD_COUNTERS}}),(Gt=qt||(qt={})).REQUEST="adfeedback_request",Gt.SUCCESS="adfeedback_success",Gt.ERROR="adfeedback_error",Gt.LABEL_RENDERED_CREATIVE="adfeedback_sponsoredlabelrendered_creative",Gt.LABEL_RENDERED_HOST="adfeedback_sponsoredlabelrendered_host";class Qt{logRequest(){Bt.csa.events().log(qt.REQUEST,this.placementName,this.placementId)}logSuccess(){Bt.csa.events().log(qt.SUCCESS,this.placementName,this.placementId)}logError(){Bt.csa.events().log(qt.ERROR,this.placementName,this.placementId)}logLabelRenderedCreative(){Bt.csa.events().log(qt.LABEL_RENDERED_CREATIVE,this.placementName,this.placementId)}logLabelRenderedHost(){Bt.csa.events().log(qt.LABEL_RENDERED_HOST,this.placementName,this.placementId)}constructor(e,t){l(this,"placementName",void 0),l(this,"placementId",void 0),this.placementName=e,this.placementId=t}}class Xt{get feedbackRequest(){return{adFeedbackRequest:{slot:this.placementName,placementId:this.placementId,endPoint:this.endpoint,feedbackDivStyle:this.feedbackDivStyle,requestUrl:this.endpoint}}}feedbackResponse(e,t){return{adFeedBackResponse:{feedbackResponseStarted:!0,feedBackResponseReturned:t,response:e}}}get renderSponsoredLabel(){return{renderSponsoredLabel:!0}}constructor(e,t,n,i){l(this,"placementName",void 0),l(this,"placementId",void 0),l(this,"endpoint",void 0),l(this,"feedbackDivStyle",void 0),this.placementName=e,this.placementId=t,this.endpoint=n,this.feedbackDivStyle=i}}const Kt=(e,t,n,i,o)=>new $t(new Pt(new Xt(e,t,n,i),o),new Ht(e,t),new Qt(e,t));class $t{request(){this.tracerService.logFeedbackRequest(),this.sendCsmCounterService.incrementRequest(),this.logCsaEventService.logRequest()}success(e){this.sendCsmCounterService.incrementSuccess(),this.logCsaEventService.logSuccess(),this.tracerService.logFeedbackResponse(!0,e)}error(){this.sendCsmCounterService.incrementError(),this.logCsaEventService.logError(),this.tracerService.logFeedbackResponse(!1)}labelRenderedCreative(){this.tracerService.logRenderSponsoredLabel(),this.sendCsmCounterService.incrementLabelRenderedCreative(),this.logCsaEventService.logLabelRenderedCreative()}labelRenderedHost(){this.tracerService.logRenderSponsoredLabel(),this.sendCsmCounterService.incrementLabelRenderedHost(),this.logCsaEventService.logLabelRenderedHost()}constructor(e,t,n){l(this,"tracerService",void 0),l(this,"sendCsmCounterService",void 0),l(this,"logCsaEventService",void 0),this.tracerService=e,this.sendCsmCounterService=t,this.logCsaEventService=n}}class Zt{isOk(){return"ok"===this.status}constructor(e,t,n){l(this,"status",void 0),l(this,"html",void 0),l(this,"script",void 0),this.status=e,this.html=t,this.script=n}}class en{async getSponsoredLabelAndFeedbackLink(e){return fetch(this.windowRepo.origin()+e).then((e=>e.ok?e.json().then((e=>Promise.resolve(new Zt(e.status,e.html,e.script)))):Promise.reject(null))).catch((()=>Promise.reject(null)))}constructor(e){l(this,"windowRepo",void 0),this.windowRepo=e}}class tn{appendChildTo(e,t){var n,i;function o(e){const t=document.createElement("div");return t.setAttribute("id",e.getHtmlId()),n(t,e.feedbackStyle),t.append(function(e){const t=document.createElement("div");return t.innerHTML=e.labelText,n(t,e.labelStyle),t}(e)),t;function n(e,t){for(const n in t)e.style.setProperty(n,t[n])}}t.position===Dt.TOP?null===(n=nn(e))||void 0===n||n.prepend(o(t)):t.position===Dt.BOTTOM&&(null===(i=nn(e))||void 0===i||i.append(o(t)))}updateElement(e,t){const n=nn(e);n&&(n.innerHTML=t.html,function(e,t){(function(e){const t=document.createElement("script");return e.prepend(t),t}(e)).innerHTML=t.script}(n,t))}clickChildLink(e){const t=document.getElementById(e.getHtmlId());var n;if(t)for(const e of t.children)if("A"===(n=e).tagName||"DIV"===n.tagName)return void e.click()}}const nn=e=>document.getElementById(e),on=()=>new an(new Nt(new tn,new en({origin:()=>window.location.origin})));class an{postSponsoredLabelWithFeedbackLink({parentHtmlId:e,placement:t,feedback:n,tracer:i}){n.hidden&&(n.style=ft(ht({},n.style),{display:"none"}),n.label.style=ft(ht({},n.label.style),{display:"none"})),this.feedbackService.createSponsoredLabelWithFeedbackLink(function(e,t){return new Ct(e,t.style,t.label.text,t.label.style,"TOP"===t.position?Dt.TOP:Dt.BOTTOM,rn(t.url.path,t.url.parameters),t.hidden)}(e,n),Kt(t.name,t.id,rn(n.url.path,n.url.parameters),n.style,i))}openModal(e){this.feedbackService.openModal(new Mt(e))}labelRendered({placement:e,feedback:t,tracer:n}){this.feedbackService.labelRendered(Kt(e.name,e.id,rn(t.url.path,t.url.parameters),t.style,n))}constructor(e){l(this,"feedbackService",void 0),this.feedbackService=e}}const rn=(e,t)=>e+"?pl="+t,sn=(e,t)=>{let n;try{n=nt(e,"pj",{measurementMethod:wt.COUNT_ON_DOWNLOAD_CLIENT})}catch(e){return ae("Unable to add pj to impression URL",e),A(null,null,$e.ERROR,1),void _e(et.ERROR)}vt(n,"ape_impression",t,(()=>{A(null,null,$e.IMPRESSION+"loaded",1),_e(et.IMPRESSION+"loaded")}),(()=>{A(null,null,$e.IMPRESSION+"error",1),_e(et.IMPRESSION+"error")})),A(null,null,It.GLOBAL_IMPRESSION_FIRED_COUNTER,1)},dn=(t,n,i,o,a,r)=>{try{var s,d;const l=document.getElementById(o[t.arid].placementDivId),c=o[t.arid].iframeId;let u=null;const p=null===window||void 0===window||null===(s=window.renderingWeblabs)||void 0===s||null===(d=s.ADPT_SF_CLIENT_LATENCY_2023Q1_632539)||void 0===d?void 0:d.toLowerCase(),m=q(t.mediaType,t.adCreativeMetaData.adProgramId);u="t1"!==p&&"t3"!==p||m?fe(t,c,n):he(t,c,i);const h=r?t.MAsfUrl:t.DAsfUrl;u.onload=()=>{_t(h,n,t.slot,t.placementId,A,_e)},l.appendChild(u),X().sendLatencyMetric({latencyMetricType:ne,placementId:t.placementId,placementName:t.slot}),A(t.slot,t.placementId,e.IFRAME_CREATED,1),_e(w.IFRAME_CREATED,t.slot,t.placementId),Ie.adMap[t.arid]={slot:l,iframe:u,options:t};const f={id:u.id,src:u.src,scrolling:u.scrolling,height:u.height,width:u.width,className:u.className,styleCssText:u.style.cssText,sandbox:u.sandbox};a[t.arid].logTrace("createSafeFrame",f)}catch(e){ae("Error creating safeFrame",e),a[t.arid]&&a[t.arid].logTrace("createSafeFrame",{error:{message:"errorCreatingSafeFrame",ex:e}})}},ln=(e,{tracer:t})=>{on().labelRendered({parentHtmlId:e.options.adPlacementMetaData.adElementId,placement:{name:e.options.slot,id:e.options.placementId},feedback:{style:e.options.feedbackDivStyle,url:{path:e.options.adFeedbackInfo.endPoint,parameters:encodeURIComponent(JSON.stringify({adPlacementMetaData:e.options.adPlacementMetaData,adCreativeMetaData:e.options.adCreativeMetaData}))}},tracer:t})},cn=e=>{on().openModal(e.options.adPlacementMetaData.adElementId)},un=(e,t)=>{X().sendLatencyMetric(ft(ht({},t),{placementName:e.options.slot,placementId:e.options.placementId}))},pn=e=>{var t;const n=e+"=",i=null===(t=decodeURIComponent(document.cookie).split("; ").find((e=>e.startsWith(n))))||void 0===t?void 0:t.split("=")[1];return i||""};const mn=new class{addAdHandler(e,t,n,i){this.ADS_HANDLERS[e]=this.ADS_HANDLERS[e]||{},this.ADS_HANDLERS[e][n]=V(i,ae,"Error within ad handler "+n+": "+t)}initializeAdIds(e,t){this.AD_IDS[e]={slotId:t,wrapperDivId:"ape_"+t+"_wrapper",placementDivId:"ape_"+t+"_placement",iframeId:"ape_"+t+"_iframe",textDivWrapperId:"ape_"+t+"_text-wrapper",textDivId:"ape_"+t+"_text",auiCardDeckId:"ape_"+t+"_aui_cardDeck"}}defaultResizeSafeFrameHandler(e){return()=>{ve(e.arid,e.size.width,e.size.height,e.maxAdWidth,Ie,this.AD_IDS)}}defaultSetResizePlacementStyle(e){return()=>{ge(e.arid,this.AD_IDS,e.resizePlacementStyle)}}generateLoadAdFunc(t){const n=()=>{var e;return null===(e=null==Ie?void 0:Ie.adMap[t.arid])||void 0===e?void 0:e.iframe};return V((()=>{const i={callbackOccurred:!0,loadAfter:t.loadAfter};this.AD_TRACERS[t.arid].logTrace("pageCallBack",i),A(t.slot,t.placementId,e.CALLBACK,1),_e(w.CALLBACK,t.slot,t.placementId);const o=this.AD_IDS[t.arid].placementDivId;if(!o)return;const a=document.getElementById(o);if(a&&!a.innerHTML){const e=re()+"/images/S/apesafeframe/ape/sf/mobile/msf-1.50.f6332db.html",i=re()+"/images/S/apesafeframe/ape/sf/mobile/msfVideo-1.50.f6332db.html",o=q(t.mediaType,t.adCreativeMetaData.adProgramId)?i:e;dn(t,o,this.buildTimeReplacements.mobileSafeFrameClientHtmlContentEncoded,this.AD_IDS,this.AD_TRACERS,!0),n()&&(r=t,s=this.AD_TRACERS[t.arid],on().postSponsoredLabelWithFeedbackLink({parentHtmlId:r.adPlacementMetaData.adElementId,placement:{id:r.placementId,name:r.slot},feedback:{position:r.adFeedbackInfo.adFeedbackOnTop?"TOP":"BOTTOM",hidden:1==!r.adFeedbackInfo.boolFeedback,style:r.feedbackDivStyle,url:{path:r.adFeedbackInfo.endPoint,parameters:encodeURIComponent(JSON.stringify({adPlacementMetaData:r.adPlacementMetaData,adCreativeMetaData:r.adCreativeMetaData}))},label:{text:G(r.adFeedbackInfo.sponsoredText),style:r.advertisementStyle}},tracer:s}))}var r,s}),ae,"Error in callback to create Safeframe.")}getUserNetworkConnectionInfo(e){const t=e&&e.userContext,n={mobileConnectionType:t&&t.mobileConnectionType,connectionType:""},i=t&&t.connectionType;if(i)n.connectionType=i.toLowerCase();else{const e=window.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);n.connectionType=t&&t.type||"unknown"}return n}trimMashCookie(e){const t=/^([.\d]*\s*)({.*})$/.exec(e),n=t[1],i=JSON.parse(t[2]),o={};return o.os=i.os,o.av=i.av,n+JSON.stringify(o)}trimCookies(e){let t="";try{if(Array.isArray(e))for(let n=0;n<e.length;n++){let i=pn(e[n]);void 0!==i&&""!==i&&("amzn-app-ctxt"===e[n]&&(i=this.trimMashCookie(i)),t+=e[n]+"="+i+"; ")}}catch(e){ae("Error parsing page cookies",e)}return t}initSafeFrame(){var t,n,i,o;window.MAsf?window.MAsf.loadAds():(window.MAsf={version:"1.50.f6332db"},"t1"===(null===window||void 0===window||null===(t=window.renderingWeblabs)||void 0===t||null===(n=t.ADPT_SF_MRC_RETEST_643771)||void 0===n?void 0:n.toLowerCase())?(A(null,null,$e.TREATMENT,1),Qe().forEach((e=>{try{sn(e,document.body),A(null,null,$e.IMPRESSION,1),_e(et.IMPRESSION)}catch(e){A(null,null,$e.ERROR,1),_e(et.ERROR)}}))):"c"===(null===window||void 0===window||null===(i=window.renderingWeblabs)||void 0===i||null===(o=i.ADPT_SF_MRC_RETEST_643771)||void 0===o?void 0:o.toLowerCase())?A(null,null,$e.CONTROL,1):(A(null,null,$e.NO_WEBLAB,1),Ge()),window.csa&&(Ae.events=window.csa("Events",{producerId:"adplacements"})),A(null,null,c.VERSION+":"+window.MAsf.version,1),_e(y.VERSION+window.MAsf.version),Ie.supportedCommands=this.supportedCommands,window.addEventListener("message",Ie.receiveMessage),window.MAsf.registerCustomMessageListener=Ie.registerCustomMessageListener,window.MAsf.sendCustomMessage=Ie.sendCustomMessage,window.MAsf.loadAds=()=>{const t="text/x-dacx-safeframe",n="data-arid",i=document.getElementsByClassName(t);for(const a of i)if("DIV"===a.tagName&&a.classList.contains(t))try{var o;const t=pt(a.getAttribute("data-csa-c-slot-id")),i=t||JSON.parse(a.getAttribute("data-ad-details"));mt(i);const r="ape_"+i.slot+"_placement",s=document.getElementById(r);if(!Ie.adMap[i.arid]&&s.innerHTML){s.innerHTML="",a.removeAttribute(n);const e="ape_"+i.slot+"_text-wrapper";document.getElementById(e)&&document.getElementById(e).remove()}if(a.getAttribute(n))continue;const d=i.slot;i.arid=i.arid||Math.random().toString(16).slice(2),this.AD_TRACERS[i.arid]=new Le(i.traceId,window[i.slotName]&&window[i.slotName].adStartTime||0),this.AD_TRACERS[i.arid].logTrace("safeFrameInput",i);const l={caches:window.caches?window.caches:null,plugins:document.plugins?document.plugins:null,cookies:document.cookie?document.cookie:null,userAgents:navigator.userAgent?navigator.userAgent:null};this.AD_TRACERS[i.arid].logTrace("browserData",l),a.setAttribute(n,i.arid),i.hostDomain=location.protocol+"//"+location.host,i.userAgent=null===window||void 0===window||null===(o=window.top)||void 0===o?void 0:o.navigator.userAgent,i.isAUIAvailable=j(),i.cookie=this.trimCookies(i.allowedCookies),i.aPageStart=window.aPageStart,i.adStartTime=window[i.slotName]&&window[i.slotName].adStartTime||0;const c=document.getElementById("ape_"+d+"_userData"),u=null==c?void 0:c.getAttribute("data-user-data");if(c&&u)try{const e=JSON.parse(u);i.userConnectionInfo=this.getUserNetworkConnectionInfo(e)}catch(e){i.userConnectionInfo={mobileConnectionType:0,connectionType:""}}const p="d3l3lkinz3f56t.cloudfront.net,g-ecx.images-amazon.com,z-ecx.images-amazon.com,images-na.ssl-images-amazon.com,g-ec4.images-amazon.com,images-cn.ssl-images-amazon.com".split(",");i.allowedDomains="object"==typeof i.allowedDomains&&i.allowedDomains.length>=0?i.allowedDomains.concat(p):p,this.addAdHandler(i.arid,d,"defaultResizeSafeFrameHandler",this.defaultResizeSafeFrameHandler(i)),this.addAdHandler(i.arid,d,"defaultSetResizePlacementStyle",this.defaultSetResizePlacementStyle(i)),this.initializeAdIds(i.arid,d),X().sendLatencyMetric({latencyMetricType:te,placementId:i.placementId,placementName:i.slot}),X().sendLatencyMetric({latencyMetricType:ee,placementId:i.placementId,placementName:i.slot}),A(d,i.placementId,e.START,1),_e(w.START,i.slot,i.placementId),"clickTracking"in i&&""===i.clickTracking&&(i.clickTracking=He(i));const m=re()+"~~MobileSafeFrameVideoPathToken~~",h=re()+"~~MobileSafeFramePathToken~~";i.safeFrameSrc=q(i.mediaType,i.adCreativeMetaData.adProgramId)?m:h;const f={hostDomain:i.hostDomain,allowedSizes:i.allowedSizes,allowedDomains:i.allowedDomains,productAdsUrl:i.productAdsUrl,parentLocation:i.parentLocation,queryParams:i.queryParams,aPageStart:i.aPageStart,adStartTime:i.adStartTime,safeFrameSrc:i.safeFrameSrc,abpStatus:i.abpStatus};Ee(i.loadAfter,this.generateLoadAdFunc(i),i.extraDelay,a,i.expParams?i.expParams.firePositionTrackerOnLoad:"false"),f.loadAfter=i.loadAfter,this.AD_TRACERS[i.arid].logTrace("additionalInitilizationParams",f)}catch(e){ae("Error parsing sf tag",e)}},window.MAsf.loadAds(),window.addEventListener("resize",(()=>{window.MAsf&&window.MAsf.sendCustomMessage("resize",{height:window.innerHeight,width:window.innerWidth})})))}constructor(e){l(this,"ADS_HANDLERS",{}),l(this,"AD_IDS",{}),l(this,"AD_TRACERS",{}),l(this,"buildTimeReplacements",void 0),l(this,"supportedCommands",{sendAdBarTrace:(e,t)=>{e.options.arid in this.AD_TRACERS&&this.AD_TRACERS[e.options.arid].logTrace(t.field,t.traceInfo)},logAPIInvocation:(e,t)=>{A(null,null,o.API+t.apiName,1),A(e.options.slot,e.options.placementId,o.API+t.apiName,1),e.options.arid in this.AD_TRACERS&&this.AD_TRACERS[e.options.arid].logTrace("apiCalls",t)},resizeSafeFrameAd:e=>{window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].defaultResizeSafeFrameHandler),ve(e.options.arid,e.options.size.width,e.options.size.height,e.options.maxAdWidth,Ie,this.AD_IDS)},setResizePlacementStyle:e=>{window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].defaultSetResizePlacementStyle),ge(e.options.arid,this.AD_IDS,e.options.resizePlacementStyle)},changeSize:(e,t)=>{const n=e.options.allowedSizes;if(void 0===e.options.allowChangeSize||e.options.allowChangeSize)if(de(t,n,se))e.iframe.style.height=t.height,e.iframe.style.width=t.width,e.slot.style.height=t.height,e.slot.style.width=t.width,window.removeEventListener("resize",this.ADS_HANDLERS[e.options.arid].defaultResizeSafeFrameHandler);else{ae("Size is not allowlisted: "+t.width+" x "+t.height+Ie.appendErrorDetails(e.options.arid))}},startPixelTracking:lt,startPixelTrackingForLegacyImpression:ut,collapseSlot:(e,t)=>{we(this.AD_IDS[e.options.arid].wrapperDivId),we(this.AD_IDS[e.options.arid].auiCardDeckId)},openInExternalBrowser:(e,t)=>{e.options.isAUIAvailable&&(t.successCallback=V((()=>{Ie.sendMessageToAd(e.options.arid,"mash.openInExternalBrowser.update",{})})),t.failCallback=V((t=>{Ie.sendMessageToAd(e.options.arid,"mash.openInExternalBrowser.update",{value:t})})),t.failCallback=V((()=>{})),P.when("mash").execute((e=>{e.openInExternalBrowser(t)})))},launchIntentURL:(e,t)=>{const n=/^https:\/\/primenow\.amazon\.(com|ca|com\.mx|com\.br|co\.uk|de|fr|it|es|in|ae|sa|nl|se|co\.jp|com\.au|com\.tr|sg|eg|pl|com\.be)\//;if(e.options.isAUIAvailable){if(void 0===t.url||void 0===t.fallbackUrl||!n.test(t.url))return;const i=V((()=>{Ie.sendMessageToAd(e.options.arid,"mash.launchIntentURL.update",{})})),o=V((n=>{window.location=t.fallbackUrl,Ie.sendMessageToAd(e.options.arid,"mash.launchIntentURL.update",{errorMsg:n})}));P.when("mash").execute((e=>{e.launchIntentURL({url:t.url,successCallback:i,failCallback:o})}))}},logError:(e,t)=>{ae(t.message+Ie.appendErrorDetails(e.options.arid)+": "+e.options.slot,t.error)},logCsaEvent:(e,t)=>{_e(t.metricName,e.options.slot,e.options.placementId)},addCsaEntity:(e,t)=>{Oe(t)},customMessage:(e,t)=>{Ie.customMessage(t.key,t.body,e.options.allowlistedCustomMessageEvents,e.options.slot,e.options.placementId)},sendLatencyMetric:(e,t)=>un(e,t),countMetric:(e,t)=>{t.isGlobal?A(null,null,t.metricMsg,t.value):A(e.options.slot,e.options.placementId,t.metricMsg,t.value)},addCsmTag:(e,t)=>{t.isGlobal?R(t.tag,null,null,t.msg):R(t.tag,e.options.slot,e.options.placementId,t.msg)},fireViewableLatencyMetrics:(e,t)=>{var n,i,o,a;n=e.options.arid,i=e.options.slot,o=e.options.placementId,a=t.adLoadedTimestamp,window.apeViewableLatencyTrackers&&window.apeViewableLatencyTrackers[n]&&window.apeViewableLatencyTrackers[n].valid&&(window.apeViewableLatencyTrackers[n].loaded=!0,window.apeViewableLatencyTrackers[n].viewed&&(X().sendLatencyMetric({latencyMetricType:ie,placementId:o,placementName:i,timestamp:new Date(a)}),A(i,o,"htmlviewed:loaded",1)))},enableViewabilityTracker:(e,t)=>{Ie.updateViewability(e.options.arid);const n=Y(20,Ie.updateViewability);if(this.addAdHandler(e.options.arid,e.options.slot,"viewabilityTracker",(()=>{n(e.options.arid)})),window.addEventListener("scroll",this.ADS_HANDLERS[e.options.arid].viewabilityTracker),window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].viewabilityTracker),document.addEventListener("visibilitychange",this.ADS_HANDLERS[e.options.arid].viewabilityTracker,!1),le()){new IntersectionObserver((()=>{Ie.updateViewability(e.options.arid)}),{threshold:[0,.5,1]}).observe(e.slot)}},enableNoInventoryViewabilityTrackerAndInvokeFallback:e=>{Ie.takeSnapshotOfSlotPosition(e.options.arid),Ie.updateNoInventoryViewability(e.options.arid),Ie.sendMessageToAd(e.options.arid,"handleFallbackBehavior",{});const t=Y(20,Ie.updateNoInventoryViewability);this.addAdHandler(e.options.arid,e.options.slot,"noInventoryViewabilityTracker",(()=>{t(e.options.arid)})),window.addEventListener("scroll",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker),window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker),document.addEventListener("visibilitychange",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker)},onPageEvent:(e,t)=>{Ee(t.eventName,V((()=>{Ie.sendMessageToAd(e.options.arid,"onPageEvent.update",{})}),ae,"Failed to send message to Ad"))},getAdInfo:(e,t)=>{const n=e.options.slot.split("_")[1];n&&(document.mobileAds=document.mobileAds||{},document.mobileAds[n]=t.mobileAdsInfo)},requestVideoAutoplay:(e,t)=>{je(e,t,Ie)},releaseVideoAutoplay:()=>{Ve()},haveVideoAutoplayPermission:e=>{We(e)},feedbackLabelRendered:e=>ln(e,{tracer:this.AD_TRACERS[e.options.arid]}),feedbackOpenModal:e=>cn(e)}),this.buildTimeReplacements=e}}({mobileSafeFrameClientHtmlContentEncoded:"~~mobileSafeFrameClientHtmlContentEncoded~~"});V((()=>mn.initSafeFrame()),ae,"Error initializing safeFrame")()}();
//# sourceMappingURL=MAsf.min.js.map
